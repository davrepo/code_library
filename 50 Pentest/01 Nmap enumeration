# ----------------- flags for Nmap -----------------
# -sV: version detection - determine the version of the service running on them
# -sC: script scanning
# -sS: TCP SYN scan, aka Stealth scan - less likely to be detected by firewalls
# -sT: TCP connect scan - connect to each port to determine if it is open or closed

# -A: aggressive mode - enable OS detection, version detection, script scanning, and traceroute
# enables a number of different features that can be useful for scanning and identifying 
# a network, but it can also be more likely to be detected by firewalls or other security 
# measures. This can make it more difficult to use Nmap without being noticed, and can 
# also increase the amount of time it takes to complete a scan. 
# Additionally, using -A mode can sometimes produce false positives or other inaccurate results, 
# so it should be used with caution.

# -Pn: skip host discovery - assume that the target host is up
# useful when you know that a host is up, but host discovery is not working for some reason. 
# For example, you might use the -Pn flag if the host is blocking ICMP pings, 
# which is a common technique used to determine if a host is up or down

# -oN: output to file - save the scan output to a file in normal text format
# -oX: output to file - save the scan output to a file in XML format
# -oG: output to file - save the scan output to a file in grepable format

# -O: OS detection - determine the operating system running on the target host

# -p-: scan all ports
# -p 1-65535: scan all ports
# -p 80,443: scan ports 80 and 443

# -v: verbose - increase the verbosity level
# -vv: very verbose - increase the verbosity level even more
# -vvv: extremely verbose - increase the verbosity level even more

# -T0: timing template - set the timing template to paranoid
# -T5: timing template - set the timing template to insane

# -n: no DNS resolution - do not resolve hostnames
# -R: enable DNS resolution - resolve hostnames

# -iL: input from file - read targets from a file
# -iR: input from random - select targets randomly from the target list

# -F: fast mode - scan only the 100 most common ports
# -r: randomize the ports scanned - scan ports in random order

# -f: fragment packets - send packets with the Don't Fragment (DF) bit set
# -D: decoy addresses - use decoy addresses to confuse the target
# -S: spoof source address - spoof the source address of the packets

# -d: increase debugging level - increase the debugging level
# -e: specify network interface - specify the network interface to use

# -6: enable IPv6 scanning - enable IPv6 scanning


# ----------------- Scanning options -----------------
# -sS: TCP SYN scan, aka Stealth scan - less likely to be detected by firewalls
# -sU: UDP scan - send a UDP packet to each port to determine if it is open or closed
# -sA: TCP ACK scan - send a TCP packet with the ACK flag set to each port to determine if it is open or closed
# -sW: TCP Window scan - send a TCP packet with the ACK and URG flags set to each port to determine if it is open or closed
# -sM: TCP Maimon scan - send a TCP packet with the FIN and URG flags set to each port to determine if it is open or closed
# -sN: TCP Null scan - send a TCP packet with the NULL flag set to each port to determine if it is open or closed
# -sF: TCP FIN scan - send a TCP packet with the FIN flag set to each port to determine if it is open or closed
# -sX: TCP Xmas scan - send a TCP packet with the FIN, PSH, and URG flags set to each port to determine if it is open or closed
# -sI: Idle scan - send a TCP packet with the FIN flag set to each port to determine if it is open or closed
# -sY: SCTP INIT scan - send an SCTP INIT packet to each port to determine if it is open or closed
# -sZ: SCTP COOKIE-ECHO scan - send an SCTP COOKIE-ECHO packet to each port to determine if it is open or closed
# -sO: IP protocol scan - send an IP packet with a protocol number set to each port to determine if it is open or closed
# -sL: list scan - list targets to scan
# -sn: ping scan - ping targets to determine if they are up or down
# -sC: script scanning - enable script scanning
# -sV: version detection - determine the version of the service running on them
# -sH: host discovery - enable host discovery
# -sP: ping scan - ping targets to determine if they are up or down
# -sR: RPC scan - scan for RPC services

# ----------------- Script scanning -----------------
# nmap -sC: default scripts, used to gather a variety of information about target hosts, 
# such as the services running on them, the operating system they are using, and any 
# vulnerabilities they may have

# nmap -sC --script vuln: only run scripts that are related to identifying vulnerabilities on target hosts

# nmap -sC --script dns-brute: run a script that performs a DNS brute force attack, 
# used to enumerate DNS records on a target host or network

# nmap -sC --script ssh-auth-methods: tests for supported SSH authentication methods on target hosts. 
# This can be useful for identifying weak authentication methods that can be exploited by attackers

# nmap -sC anon: tests for anonymous FTP access


# ----------------- Common Scans -----------------

# standard port scanning
export ip=10.10.60.144   # set the IP address
nmap -sV -Pn -oN nmap-$ip.out $ip   # scan the IP address and save the output to a file
nmap -A -p- -Pn -T4 -oN nmap-$ip.out $ip
cat nmap-$ip.out | grep open  # show the open ports

# if do not output to file:
nmap -sV -Pn 10.10.44.32

# Thorough port scanning
nmap -A -p- -Pn -oN nmap-$ip.out $ip
nmap -A -p- -Pn -T4 <ip> -vv

# Linux delete files with names nmap-*
rm nmap-*




